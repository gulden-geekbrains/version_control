
# How to work with git - Подсказка по Git  


## Инициализация репозитория

```sh
git init
```

## Статус репозитория

```sh
git status
```

## **Создать новый репозиторий**
__git init__ - создать новый проект в текущей директории

__git init folder-name__ - создать новый проект в указанной директории

# **Клонирование репозитория**
### __Клонировать удаленный репозиторий в одноименную директорию__
    git clone https://github.com/cyberspacedk/Git-commands.git    

### __Клонировать удаленный репозиторий в директорию «FolderName»__
    git clone https://github.com/cyberspacedk/Git-commands.git FolderName 

### __Клонировать репозиторий в текущую директорию__
    git clone https://github.com:nicothin/web-design.git .           

## __Просмотр изменений__
__git status__ - показать состояние репозитория (отслеживаемые, изменённые, новые файлы и пр.)

__git diff__ - сравнить рабочую директорию и индекс (неотслеживаемые файлы ИГНОРИРУЮТСЯ)

__git diff --color-words__ - сравнить рабочую директорию и индекс, показать отличия в словах (неотслеживаемые файлы ИГНОРИРУЮТСЯ)

__git diff index.html__ - сравнить файл из рабочей директории и индекс

__git diff HEAD__ - сравнить рабочую директорию и коммит, на который указывает HEAD (неотслеживаемые файлы ИГНОРИРУЮТСЯ)

__git diff --staged__ - сравнить индекс и коммит с HEAD

__git diff master feature__ - посмотреть что сделано в ветке feature по сравнению с веткой master

__git diff --name-only master feature__ - посмотреть что сделано в ветке feature по сравнению с веткой master, показать только имена файлов

__git diff master...feature__ - посмотреть что сделано в ветке feature с момента (коммита) расхождения с master

  
  
## Подсказка по __Git Push__. (*Что такое git push и как его использовать*?)
Команда *__Git push__* позволяет отправлять локальную ветку на удаленный репозиторий. Дополнительно для синхронизации еще используют *__git pull__* для получения изменений с сервера и *__git remote__*, чтобы получить список удаленных подключений к репозиторию


### *__Отправка изменений в чистый репозиторий__*

Перед пушем надо связать локальный и удаленный репозитории. Делается это при помощи команды:
        
        git remote add <repository_name> link

Вместо *__repository_name__* нужно дать имя удаленному репозиторию. Далее в инструкции вместо этого параметра мы будем использовать origin, так как чаще всего используют это имя.

Вместо *__link__* — ссылка на удаленный репозиторий, она может выглядеть по-разному в зависимости от того используется ssh или https. 

### *__Отправка изменений__*
Перед пушем надо зафиксировать текущие изменения, то есть сделать *__git commit__*.

Далее для отправки в терминале пишем:


    git push origin <branch> 
Вместо *__branch__* — имя ветки, которую надо отправить. Чаще всего используется master или main: 


    git push origin master
Такое каждый раз писать слишком громоздко, для этого придумали *git push* по умолчанию. Для этого единожды набираем предыдущую команду с флагом *-u*:


    git push -u origin master 
После этого можно писать более коротко, так как git запомнил, что пушить надо на сервер *origin* ветку под именем *master*:


    git push
Таким образом, *git* позволяет запушить ветку в удаленный репозиторий. Чтобы через git добавить ветку в удаленный репозиторий, надо запушить существующую локальную ветку.

__Дополнительные опции публикации__

*__Отправка ветки на сервер в ветку с другим именем__*

Для того чтобы сделать *git push* в другую ветку, есть специальный синтаксис, где после имени ветки через двоеточие пишется имя удаленной ветки:

    git push origin branch:server_branch

где *branch* – имя локальной ветки, *server_branch* – имя удаленной ветки на сервере.

*__Отправка всех веток на сервер__*

Вместо имени ветки пишем  флаг *—all*: 


    git push origin --all

После этого все зафиксированные изменения в ветках отправятся в удаленный репозиторий.

*__Отправка текущей ветки__*

Удобный способ отправить текущую ветку с тем же именем на сервере.


    git push origin HEAD 

*HEAD* указывает на текущую ветку (*current branch*). Тем самым, не надо запоминать имя ветки, на которой вы находитесь.

__Принудительная публикация (git push —force …)__

При отправке может произойти ошибка публикации.

    To github.com:example/test.git
    ! [rejected]        master -> master (fetch first)
    error: не удалось отправить некоторые ссылки в 
    «github.com:example/test.git»

Это так называемый *git push rejected*, он означает что пуш был отклонен. Правильнее всего — сделать то, что написано в подсказке к ошибке. Надо получить и смержить изменения, затем снова отправить. 

Флагом *—force* или сокращенной его версией *-f* отключается проверка коммитов и при необходимости выполняется перезапись истории.

    git push --force

Нужно быть аккуратными с этой командой, так как она стирает работу других людей. Эта команда оправдана лишь изредка, например, если вы почти сразу внесли изменения коммита с помощью *git commit —amend* и запушили до того, как кто-то сделал *git pull*. 

  

__Принудительная публикация с параметром (git push —force-with-lease …)__

Это более безопасный, но так же нерекомендуемый вариант вариант принудительного пушинга. Он не перезапишет работу в удаленной ветке, если в нее были добавлены коммиты от других людей.

    git push --force-with-lease

Принудительная публикация с этим параметром чревата появлением *git push rejected* у других людей.

## *Продвинутые возможности*

__Удаление локальных данных (prune)__

Если на сервере была удалена ветка, то локально она все еще существует. Чтобы удалить все локальные ветки, которых нет на сервере:

    git remote prune origin

__Проверить, удастся ли пушинг (dry run option)__

С этой опцией пушинг фактически не произойдет, но покажет вывод словно он произошел.

    git push --dry-run

Так можно получить ошибку, которая могла бы произойти, и поправить ее заранее.

__Атомарный пушинг (*atomic option*)__

Если отправить несколько веток на сервер, некоторые могут быть приняты, а другие — нет. Иногда это не то поведение, которое ожидалось. Например, пушинг делает некоторая проверяющая система и ожидаемое поведение такое: либо все будут приняты, либо все будут отклонены. В таких случаях надо делать пушинг атомарно:

    git push --atomic origin branch1 branch2 …


В этой инструкции были представлены наиболее частые сценарии использования *__git push__*.